@{
    ViewData["Title"] = " Story Details Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model GeneralViewModel
@using System.Security.Claims;
@{
    var identity = User.Identity as ClaimsIdentity;
    var name = identity?.FindFirst(ClaimTypes.Name)?.Value;
    var surname = identity?.FindFirst(ClaimTypes.Surname)?.Value;
    var Email = identity?.FindFirst(ClaimTypes.Email)?.Value;
    var uid = identity?.FindFirst(ClaimTypes.Sid)?.Value;
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="~/css/StoryDetails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <title>StoryDetails</title>
</head>
<body>
    <partial name="_AllNavbar" />

    <div class="container">
        <div class="d-flex mt-5">
            <div class="row">
                <div class="col-lg-6 col-md-12 col-sm-12">
                    <div class="container h-100">
                        <div class="" style="height:80%">
                            <!-- Full-width images with number text -->
                            <div class="mySlides  h-100">
                                <img src="~/images/Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png"
                                    style="width:100%"  class="h-100">
                            </div>
                            <div class="mySlides h-100">
                                    <img src="~/images/Assets/Grow-Trees-On-the-path-to-environment-sustainability.png"
                                        style="width:100%"  class="h-100">
                            </div>
                            <div class="mySlides h-100">
                                <img src="~/images/Assets/Grow-Trees-On-the-path-to-environment-sustainability.png"
                                    style="width:100%"  class="h-100">
                            </div>
                            <div class="mySlides h-100">
                                    <img src="~/images/Assets/img33.png" style="width:100%"  class="h-100">
                            </div>
                            <div class="mySlides h-100">
                                <img src="~/images/Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png"
                                    style="width:100%"  class="h-100">
                            </div>
                            <div class="mySlides h-100">
                                <img src="~/images/Assets/img33.png" style="width:100%"  class="h-100">
                            </div> 
                            <!-- Next and previous buttons -->
                            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                            <a class="next" onclick="plusSlides(1)">&#10095;</a>       
                        </div>
                            <!-- Thumbnail images -->
                    <div class="row mt-2" style="height:15%">
                            <div class="col-lg-3 col-md-3 col-sm-3 col-3">
                                <img class="demo cursor"
                                    src="~/images/Assets/CSR-initiative-stands-for-Coffee--and-Farmer-Equity-4.png"
                                    style="width:100%" onclick="currentSlide(1)" alt="The Woods"  class="h-100">
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-3 col-3">
                                <img class="demo cursor" src="~/images/Assets/img3.png" style="width:100%"
                                    onclick="currentSlide(2)" alt="Cinque Terre"  class="h-100">
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-3 col-3">
                                <img class="demo cursor"
                                    src="~/images/Assets/Grow-Trees-On-the-path-to-environment-sustainability-5.png"
                                    style="width:100%" onclick="currentSlide(3)" alt="Mountains and fjords"  class="h-100">
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-3 col-3">
                                <img class="demo cursor" src="~/images/Assets/img33.png" style="width:100%"
                                    onclick="currentSlide(4)" alt="Northern Lights"  class="h-100">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6 col-md-12 col-sm-12">
                    
                    @if (User.Identity.IsAuthenticated)
                    {
                   
                        <img src="@Model?.Users.Where(x=>x.UserId == @Model.story_details.UserId).Select(x=>x.Avatar).FirstOrDefault()" alt=""
                                                                    style="height:20%;width:20%;border-radius:50%">
                        <div class="d-flex justify-content-between">
                            <div>@Model?.firstName @Model.lastName</div>
                            <div>
                                <button style="background:none;border:2px solid gray;border-radius:30px;">
                                    <img src="~/Assets/eye.png" />@Model.story_details.Views View
                                </button>
                            </div>
                        </div>

                    }
                    
                    <p>@Html.Raw(@Model?.story_details.Description) 
                        Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                                dolorem quibusdam obcaecati <br /><br />mollitia eos aliquid earum delectus neque quaerat ratione dolore
                                iusto unde! Deserunt Lorem ipsum dolor sit amet consectetur adipisicing elit. Veniam maxime nam
                                vitae. Sit nobis<br /> repellendus praesentium dolor, fuga ipsum! Veritatis numquam fugiat nam aspernatur
                                consectetur amet non. Corporis, asperiores harum.<br /><br />
                               
                                quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                                    iusto unde!
                                    Deserunt quibusdam obcaecati mollitia eos aliquid earum delectus neque
                    </p>
                    <div class="row mt-4">
                            <div class="col-lg-6 col-11 text-center"> 
                                @if (User.Identity.IsAuthenticated)
                                {
                                    <div class="btn">
                                        @*recommended*@
                                        <button id="show" type="button" class=" ms-4" style="background:none;border:2px solid gray;border-radius:30px;padding:5px"><img src="~/Assets/add1.png" />Recommended To Co-Worker
                                        </button>
                                        <dialog id="myDialog">
                                            <ul>
                                                @foreach (var n in Model.Users)
                                                {
                                                    if (n.Email != Email)
                                                    {
                                                        <li class="form-check " style="margin-left:-50%">
                                                            <img src="@Model.Users.Where(x=>x.UserId == n.UserId).Select(x=>x.Avatar).FirstOrDefault()" alt=""
                                                                style="height:15%;width:15%;">
                                                            <input type="checkbox" value="@n.UserId" id="check">
                                                            <label class="form-check-label" for="to">
                                                                @n.FirstName &emsp; @n.LastName
                                                            </label>
                                                        </li>
                                                    }
                                                }
                                            </ul>
                                            <button class="form-control btn btn-outline-primary m-2" onclick="recommend(@Model.story_details.MissionId)">Send an email</button>
                                            <button class="form-control btn btn-outline-danger m-2" id="hide">Close</button>
                                        </dialog>
                                    </div>
                                }
                                else
                                {
                                    <button class="Recommend ms-4"><img src="~/Assets/add1.png" alt="">Recommend to
                                        co-worker
                                    </button>
                                }
                            </div>
                            <div class="col-lg-6 col-12 text-center">
                               
                                <a  asp-controller="Home" asp-action="Volunteer" asp-route-id="@Model.mission_details.MissionId"  class="btn buttonColor mt-2" id="login" 
                                    style="width:auto;border-radius: 20px;border:2px solid #F88634;color: #F88634">Open Mission
                                     &ensp;<img src="~/images/Assets/right-arrow.png" alt="">
                                </a>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row ">
            <div class="col-lg-12 mt-5">
                <ul class="nav nav-tabs mb-3" id="myTab0" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active mission" id="home-tab0" data-bs-toggle="tab"
                            data-bs-target="#home0" type="button" role="tab" aria-controls="home" aria-selected="true"
                            style="color:rgb(30, 29, 29)"><h4>@Model.story_details.Title</h4>    
                        </button>
                    </li>                              
                </ul>
            </div>
            <div class="tab-content" id="myTabContent0">
                <div class="tab-pane fade show active" id="home0" role="tabpanel" aria-labelledby="home-tab0">
                    
                    <div class="text">
                        <p> <br />@Html.Raw(@Model.story_details.Description)  
                                quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                                iusto unde!
                                Deserunt quibusdam obcaecati mollitia eos aliquid earum delectus neque
                        </p>
                        <p>
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                            dolorem quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                            iusto unde! Deserunt
                                
                        </p>
                        <p>
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                            dolorem quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                            iusto unde! Deserunt Lorem ipsum dolor sit amet consectetur adipisicing elit. Veniam maxime nam
                            vitae. Sit nobis repellendus praesentium dolor, fuga ipsum! Veritatis numquam fugiat nam aspernatur
                            consectetur amet non. Corporis, asperiores harum. 
                        </p>
                    </div>          
                    <div class="text">
                        <p>
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                            dolorem quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                            iusto unde! Deserunt
                                
                        </p>
                        <p>    
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                            dolorem
                            quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                            iusto unde!
                            Deserunt
                        </p>
                        <p>
                            Lorem ipsum dolor, sit amet consectetur adipisicing elit. Deserunt, omnis ducimus,
                            dolorem
                            quibusdam obcaecati mollitia eos aliquid earum delectus neque quaerat ratione dolore
                            iusto unde!
                            Deserunt Lorem ipsum dolor sit amet consectetur adipisicing elit. Veniam maxime nam
                            vitae. Sit
                            nobis repellendus praesentium dolor, fuga ipsum! Veritatis numquam fugiat nam aspernatur
                            consectetur amet non. Corporis, asperiores harum.
                        </p>
                    </div>
                    
                   
                </div>                  
            </div>    
        </div>
    </div>
     <div class="container-fluid">
            <div class="d-flex justify-content-between py-4 my-4 border-top">
                <p style="margin-left:290px">Privacy Policy</p>
                <ul class="list-unstyled d-flex">
                  <li class="ms-3"><a class="link-dark" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#twitter"></use></svg></a></li>
                  <li class="ms-3"><a class="link-dark" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#instagram"></use></svg></a></li>
                  <li class="ms-3"><a class="link-dark" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#facebook"></use></svg></a></li>
                </ul>
              </div>
        </div>
    <script src="~/js/StoryDetails.js"></script>
    <script>
        //Recommenrded
    var dialog = document.getElementById('myDialog');
    document.getElementById('show').onclick = function () { dialog.showModal(); };
    document.getElementById('hide').onclick = function () { dialog.close(); };

    function recommend(id) {
        var to = [];
        $("input:checkbox[id=check]:checked").each(function () {
            to.push($(this).val());
        });
        $.ajax({
            url: "/Home/Recommend",
            type: "POST",
            data: {
                "missionid": id,
                to: to
            }
        });
    }
    </script>
</body>
</html>